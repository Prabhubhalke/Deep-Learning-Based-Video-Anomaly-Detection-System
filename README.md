# Deep-Learning-Based-Video-Anomaly-Detection-System
# Video Anomaly Detection System

This is a complete video anomaly detection system that can classify videos as "Normal" or "Anomaly" using deep learning techniques. The system uses EfficientNetB0 for feature extraction and a custom neural network for classification. It now includes advanced Gemini AI integration for faster, more natural language report generation and video explanation features.

## Project Structure

```
├── data/
│   ├── train_frames_2/          # Training frames extracted from videos
│   │   ├── anomaly/
│   │   └── normal/
│   ├── test_frames_2/           # Testing frames extracted from videos
│   │   ├── anomaly/
│   │   └── normal/
│   ├── prepared_data/           # Prepared datasets and trained models
│   │   ├── X_train.npy
│   │   ├── y_train.npy
│   │   ├── X_test.npy
│   │   ├── y_test.npy
│   │   ├── label_encoder.npy
│   │   ├── anomaly_detection_model.h5
│   │   └── high_accuracy_model.h5
│   └── *.mp4                   # Original video files
├── train2.csv                  # Training video labels
├── test2.csv                   # Testing video labels
├── extract.py                  # Frame extraction script
├── main.py                     # Main training script
├── high_accuracy.py            # High accuracy model training
├── batch_analyze.py            # Batch video analysis
├── video_analyzer.py           # Detailed video analysis
├── enhanced_video_analyzer.py  # Enhanced YOLO-based analysis
├── optimized_video_analyzer.py # Optimized fast analysis
├── gemini_analyzer.py          # Gemini AI report generation
├── video_explainer.py          # Video explanation generation
├── application.py              # GUI application
└── requirements.txt            # Python dependencies
```

## Installation

1. Install the required dependencies:
```bash
pip install -r requirements.txt
```

## Usage

### 1. Data Preparation

The system requires labeled video data in CSV files:
- `train2.csv`: Training data with video names and labels
- `test2.csv`: Testing data with video names and labels

Example format:
```csv
video_name,label
video1.mp4,normal
video2.mp4,anomaly
```

### 2. Frame Extraction

Run the frame extraction script to convert videos to frames:
```bash
python extract.py
```

This will create frame directories in `data/train_frames_2` and `data/test_frames_2`.

### 3. Model Training

Train the model using the prepared dataset:
```bash
python main.py
```

For higher accuracy training:
```bash
python high_accuracy.py
```

### 4. Batch Analysis

Analyze multiple videos at once:
```bash
python batch_analyze.py
```

### 5. GUI Application

Run the graphical user interface:
```bash
python application.py
```

The GUI application provides:
- Video file selection
- Real-time video playback
- Anomaly detection with confidence scores
- Sensitivity mode selection (High/Low)
- Detailed analysis reports
- Enhanced YOLO-based object detection
- Natural language reports powered by Gemini AI
- Multiple analysis modes (Quick, Balanced, Detailed)
- Video explanation feature for concise summaries

## Features

- **Deep Learning Model**: Uses EfficientNetB0 for feature extraction and custom neural networks for classification
- **Real-time Processing**: Processes videos in real-time for immediate feedback
- **Multiple Sensitivity Modes**: Adjustable sensitivity for different use cases
- **Detailed Analysis**: Provides comprehensive reports for detected anomalies
- **Batch Processing**: Analyze multiple videos simultaneously
- **GUI Interface**: User-friendly graphical interface for easy operation
- **Gemini AI Integration**: Generates natural language reports using Google's Gemini API for faster analysis
- **Video Explanation Feature**: Creates concise, professional summaries of video content
- **Enhanced YOLO Analysis**: Uses YOLOv8 models for detailed object detection and anomaly classification
- **Optimized Processing**: Multiple analysis modes for balancing speed and accuracy

## Model Performance

The trained model achieves good accuracy on the test dataset with:
- Precision, Recall, and F1-Score metrics displayed during training
- Binary classification between "Normal" and "Anomaly" classes

The enhanced system also provides:
- Real-time object detection using YOLOv8 models
- Anomaly classification into specific types (crowd, violence, chaos, abuse, suspicious_items)
- Natural language analysis reports generated by Gemini AI
- Video explanations with professional summaries
- Multiple processing modes for different speed/accuracy requirements

### Analysis Modes

The system offers three analysis modes to balance speed and accuracy:

1. **Quick Mode**: Uses YOLOv8 nano model for fastest processing (lower accuracy)
2. **Balanced Mode**: Uses YOLOv8 small model for balanced speed/accuracy
3. **Detailed Mode**: Uses YOLOv8 medium model for highest accuracy (slower processing)

Users can select the appropriate mode based on their needs through the GUI interface.

## Requirements

- Python 3.7+
- TensorFlow 2.10+
- OpenCV-Python 4.5+
- NumPy 1.21+
- Pandas 1.3+
- Scikit-learn 1.0+
- PySide6 6.0+
- Ultralytics 8.0+ (for YOLO-based analysis)
- Google Generative AI 0.3+ (for Gemini AI integration)
- Python-dotenv 0.19+ (for environment management)

See `requirements.txt` for the complete list of dependencies.

## Video Explanation Feature

The system now includes an advanced video explanation feature that generates concise, professional descriptions of what's happening in analyzed videos using Gemini AI. This feature provides:

- **Concise Summaries**: 3-5 line professional explanations of video content
- **Human-like Reporting**: Explanations written in a style similar to human security analysts
- **Anomaly Focus**: Highlights key activities and anomalies detected in the video
- **Automatic Integration**: Video explanations are automatically prepended to analysis reports

## Gemini AI Integration

The system now includes integration with Google's Gemini AI for faster, more natural language report generation. This integration provides:

- **Natural Language Reports**: Human-readable analysis reports generated by Gemini AI
- **Faster Processing**: Cloud-based AI processing reduces local computation time
- **Professional Formatting**: Well-structured reports with executive summaries, findings, and recommendations
- **Fallback Mechanism**: Automatic fallback to traditional report generation if AI service is unavailable

To use the Gemini AI integration:

1. Add your Google AI API key to the `.env` file:
   ```
   GOOGLE_AI_API_KEY=your_api_key_here
   ```
2. Install the required dependencies:
   ```bash
   pip install -r requirements.txt
   ```
3. The system will automatically use Gemini AI when generating detailed analysis reports

The Gemini AI integration enhances the user experience by providing more intuitive and actionable analysis reports while maintaining the accuracy of the underlying detection algorithms.
